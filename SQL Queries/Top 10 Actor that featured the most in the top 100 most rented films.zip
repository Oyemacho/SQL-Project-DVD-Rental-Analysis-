--Top 10 Actors that featured the most in the top 100 most rented films--
SELECT a.actor_id,
		CONCAT(a.first_name||' '|| a.last_name) as Full_name, 
		COUNT(a.*) Film_count
FROM film f
JOIN film_actor fm
ON f.film_id = fm.film_id
JOIN actor a
ON fm.actor_id = a.actor_id
WHERE f.title IN
			(SELECT title
			FROM
					(SELECT  f.film_id,title, COUNT(r.*) rental_count 
					FROM film f
					JOIN inventory i
					ON f.film_id = i.film_id
					JOIN rental r
					ON i.inventory_id = r.inventory_id
					GROUP BY 1,2
					ORDER BY 3 DESC
					LIMIT 100)tb1
			)
GROUP BY 1,2			
order by 3 DESC
LIMIT 10;